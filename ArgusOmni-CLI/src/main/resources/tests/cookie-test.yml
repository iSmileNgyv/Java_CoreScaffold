# ArgusOmni Cookie Support Test
# Tests automatic and manual cookie handling

env:
  api_url: "https://httpbin.org"

tests:
  # ==========================================
  # Test 1: Manual Cookie
  # ==========================================
  - name: "Send manual cookie"
    rest:
      url: "{{api_url}}/cookies"
      method: GET
      cookies:
        session_id: "test-session-123"
        user_token: "abc-xyz-789"
    expect:
      status: 200

  # ==========================================
  # Test 2: Auto Cookie (Simulated with httpbin)
  # ==========================================
  - name: "Set cookie (auto mode)"
    rest:
      url: "{{api_url}}/cookies/set?session=auto-test-456"
      method: GET
      cookies: auto
    expect:
      status: 302

  - name: "Verify auto cookie persisted"
    rest:
      url: "{{api_url}}/cookies"
      method: GET
      cookies: auto
    expect:
      status: 200

  # ==========================================
  # Test 3: Mixed (Auto + Manual)
  # ==========================================
  - name: "Set another cookie"
    rest:
      url: "{{api_url}}/cookies/set?user=john-doe"
      method: GET
      cookies: auto
    expect:
      status: 302

  - name: "Send auto + manual cookies"
    rest:
      url: "{{api_url}}/cookies"
      method: GET
      cookies:
        auto: true
        custom_header: "my-custom-value"
    expect:
      status: 200
